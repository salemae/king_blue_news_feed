<!DOCTYPE html>
<html>
<head>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
    <title>King Blue | Email Schedule</title>
</head>
<body>
    {% include 'navbar.html' %}
    <!-- Add padding between navigation bar and main content -->
    <div style="padding-top: 60px;"></div>
    <section class="ui primary vertical masthead aligned segment">
        <div class="ui container">
            {% for category, message in get_flashed_messages(with_categories=true) %}
            <div class="ui {{ category }} message">{{ message }}</div>
            {% endfor %}
            <div class="ui message">
                The current delivery time is set to: {{ "%02d:%02d" % (email_schedule[1] % 12, email_schedule[2]) }} {{ "AM" if email_schedule[1] < 12 else "PM" }} <br>
                {% if minutes_remaining > 0 %}
                {% set hours_remaining = minutes_remaining // 60 %}
                {% set remaining_minutes = minutes_remaining % 60 %}
                {% if hours_remaining > 0 %}
                    {{ hours_remaining }} {{ "hour" if hours_remaining == 1 else "hours" }},
                {% endif %}
                {{ remaining_minutes }} {{ "minute" if remaining_minutes == 1 else "minutes" }} remaining until the next email delivery.
                {% else %}
                    The next email delivery is in progress or overdue.
                {% endif %}
            </div>
            

            <div class="ui segment">
                <h1 class="ui header">Email Schedule Configuration</h1>
                <p>Set the time for email delivery:</p>
                <form class="ui form" method="post" action="/configure_schedule">
                    <div class="two fields">
                        <div class="field">
                            <label>Delivery Hour</label>
                            <div class="ui selection dropdown">
                                <input type="hidden" name="hour">
                                <i class="dropdown icon"></i>
                                <div class="default text">Select Hour</div>
                                <div class="menu">
                                    {% for hour in range(24) %}
                                        <div class="item" data-value="{{ hour }}">{{ hour }}</div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                        <div class="field">
                            <label>Delivery Minute</label>
                            <div class="ui selection dropdown">
                                <input type="hidden" name="minute">
                                <i class="dropdown icon"></i>
                                <div class="default text">Select Minute</div>
                                <div class="menu">
                                    {% for minute in range(60) %}
                                        <div class="item" data-value="{{ minute }}">{{ minute }}</div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                    <button class="ui button" type="submit">Update Email Schedule</button>
                </form>
            </div>
        </div>
    </section>

    
        
    </section>
    {% include 'help_modal.html' %}
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>
    <script>
        // JavaScript to show the help modal
        $(document).ready(function() {
            $('#helpButton').click(function() {
                $('#helpModal').modal('show');
            });
        });
    </script>
        <script>
            $(document).ready(function() {
                $('.ui.dropdown').dropdown();
            });
        </script>
</body>
</html>
